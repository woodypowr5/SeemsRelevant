app.service("RegisterService",function(t){var e=[],s=50;this.getState=function(t,s){var a=s||0;return e[a].state[t]},this.setState=function(t,s,a){var n=a||0;e[n].state[t]=s},this.get=function(t){return t?e[t]:e},this.createRegister=function(t){function s(){a(),e[e.length]=i}function a(){i.state={},i.state.position=0,i.state.comparing={block1:null,block2:null},i.state.sorted=!1,i.state.speed=o||200,i.state.color=u,i.state.swapping={block1:null,block2:null},i.state.squareWidth=d||0,i.state.outerIndex=0,i.state.innerIndex=0,i.state.depth=h||"quick",i.state.ctx=c||void 0,i.state.smallestElement=x||void 0}if(t){var n=t[0],r=t[1],i={values:null,state:[]},l=t[2],o=t[3],u=t[4],d=t[4],h=t[5],c=t[6],x=t[7];if("random"===r){for(var I=[],v=0;n>v;v++)I.push(Math.random());return i.values=I,s(),e.length}if("sorted"===r){for(var I=[],v=0;n>v;v++)I.push(v/n);return i.values=I,s(),e.length}if(r.length<0){i.values=[];for(var v=0;v<r.length;v++)i.values[v]=r[v];return s(),e.length}}else e.push("invalid create() register params")},this.clearRegisters=function(){e=[]},this.sort=function(t,s){var a=t||0;e[a].state.algorithm=s[0][0],e[a].state.squareWidth=s[0][2],e[a].state.depth=s[0][3],e[a].state.ctx=s[0][8],"selectionSort"===e[a].state.algorithm?this.selectionSort():"insertionSort"===e[a].state.algorithm?this.insertionSort():console.log("not yet implemented")},this.getColorValue=function(t,s){if("grayscale"===e[0].state.color){var a=Math.round(255*t);return"rgb("+a+", "+a+", "+a+")"}if("color"===e[0].state.color){var n,r,i,l=null;return 1/6>=t?(l=255*t*6,n=0,r=l,i=255):t>1/6&&2/6>=t?(l=255*(t-1/6)*6,n=0,r=255,i=255-l):t>2/6&&.5>=t?(l=255*(t-2/6)*6,n=l,r=255,i=0):t>.5&&4/6>=t?(l=255*(t-.5)*6,n=255,r=255-l,i=0):t>4/6&&5/6>=t?(l=255*(t-4/6)*6,n=255,r=0,i=l):t>5/6&&1>=t&&(l=255*(t-5/6)*6,n=255-l,r=0,i=255),"rgb("+Math.round(n)+", "+Math.round(r)+", "+Math.round(i)+")"}},this.drawRegister=function(){for(var t=e[0].state.ctx,s=0;s<this.get(0)[0].values.length;s++){var a=this.get(0)[0].values[s];t.fillStyle=this.getColorValue(a,e[0].state.color),t.fillRect(s*e[0].state.squareWidth-1,e[0].state.squareWidth*e[0].state.outerIndex-1,e[0].state.squareWidth+2,e[0].state.squareWidth+2)}},this.innerLoopSelectionSortFull=function(t,s){0===e[0].state.innerIndex&&(e[0].state.innerIndex=e[0].state.outerIndex+1,e[0].state.smallestElement=e[0].state.outerIndex),e[0].state.ctx.strokeStyle="blue",e[0].state.ctx.lineWidth=4,e[0].state.ctx.strokeRect(e[0].state.smallestElement*e[0].state.squareWidth+1,e[0].state.squareWidth*e[0].state.outerIndex+1,e[0].state.squareWidth-4,e[0].state.squareWidth-4),e[0].state.ctx.strokeStyle="green",e[0].state.ctx.lineWidth=4,e[0].state.ctx.strokeRect(e[0].state.innerIndex*e[0].state.squareWidth+1,e[0].state.squareWidth*e[0].state.outerIndex+1,e[0].state.squareWidth-4,e[0].state.squareWidth-4),e[0].state.innerIndex<e[0].values.length&&e[0].values[e[0].state.innerIndex]<e[0].values[e[0].state.smallestElement]&&(e[0].state.smallestElement=e[0].state.innerIndex),e[0].state.innerIndex++},this.innerLoopSelectionSort=function(t,s){for(e[0].state.innerIndex=e[0].state.outerIndex+1,e[0].state.ctx.strokeStyle="green",e[0].state.ctx.lineWidth=4,e[0].state.ctx.strokeRect(e[0].state.outerIndex*e[0].state.squareWidth+1,e[0].state.squareWidth*e[0].state.outerIndex+1,e[0].state.squareWidth-4,e[0].state.squareWidth-4),e[0].state.smallestElement=e[0].state.outerIndex,e[0].state.innerIndex=e[0].state.outerIndex+1;e[0].state.innerIndex<e[0].values.length;e[0].state.innerIndex++)e[0].values[e[0].state.innerIndex]<e[0].values[e[0].state.smallestElement]&&(e[0].state.smallestElement=e[0].state.innerIndex);e[0].state.ctx.strokeStyle="blue",e[0].state.ctx.lineWidth=4,e[0].state.ctx.strokeRect(e[0].state.smallestElement*e[0].state.squareWidth+1,e[0].state.squareWidth*e[0].state.outerIndex+1,e[0].state.squareWidth-4,e[0].state.squareWidth-4),this.swap(e[0].state.outerIndex,e[0].state.smallestElement),e[0].state.innerIndex=0},this.selectionSort=function(){if(e[0].state.outerIndex===e[0].values.length-1)return void(e[0].state.sorted=!0);var t=e[0].values.slice(0,e[0].state.outerIndex),s=e[0].values.slice(e[0].state.outerIndex,e[0].values.length);e[0].state.outerIndex<e[0].values.length&&(0===e[0].state.innerIndex&&this.drawRegister(),"quick"===e[0].state.depth?(this.innerLoopSelectionSort(t,s),e[0].state.outerIndex++):"full"===e[0].state.depth&&(this.drawRegister(),e[0].state.innerIndex===e[0].values.length&&(e[0].state.ctx.strokeStyle="blue",e[0].state.ctx.lineWidth=4,e[0].state.ctx.strokeRect(e[0].state.smallestElement*e[0].state.squareWidth+1,e[0].state.squareWidth*e[0].state.outerIndex+1,e[0].state.squareWidth-4,e[0].state.squareWidth-4),this.drawRegister(),e[0].state.ctx.strokeStyle="red",e[0].state.ctx.lineWidth=2,e[0].state.ctx.strokeRect(e[0].state.outerIndex*e[0].state.squareWidth+0,e[0].state.squareWidth*e[0].state.outerIndex+0,e[0].state.squareWidth-2,e[0].state.squareWidth-2),e[0].state.ctx.strokeStyle="red",e[0].state.ctx.lineWidth=2,e[0].state.ctx.strokeRect(e[0].state.smallestElement*e[0].state.squareWidth+0,e[0].state.squareWidth*e[0].state.outerIndex+0,e[0].state.squareWidth-2,e[0].state.squareWidth-2),this.swap(e[0].state.outerIndex,e[0].state.smallestElement),e[0].state.innerIndex=0,e[0].state.outerIndex++),this.innerLoopSelectionSortFull(t,s)))},this.swap=function(t,s,a){var n=e[0].values[t];e[0].values[t]=e[0].values[s],e[0].values[s]=n},this.insertionSort=function(){return e[0].state.outerIndex===e[0].values.length?(e[0].state.sorted=!0,void this.drawRegister()):(e[0].state.outerIndex<e[0].values.length+1&&("quick"===e[0].state.depth&&this.drawRegister(),e[0].state.position=e[0].values[e[0].state.outerIndex],this.insertionSortInner(),e[0].values[e[0].state.innerIndex+1]=e[0].state.position),void e[0].state.outerIndex++)},this.insertionSortInner=function(){for(e[0].state.innerIndex=e[0].state.outerIndex-1;e[0].state.innerIndex>-1&&e[0].values[e[0].state.innerIndex]>e[0].state.position;e[0].state.innerIndex--)e[0].values[e[0].state.innerIndex+1]=e[0].values[e[0].state.innerIndex]}});